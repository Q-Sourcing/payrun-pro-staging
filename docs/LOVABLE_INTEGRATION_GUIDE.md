# ðŸ”§ Lovable Auto-Deployment Integration Guide

## Overview
This guide helps you verify that Lovable AI is properly integrated with your GitHub repository for automatic deployments.

## ðŸŽ¯ Expected Lovable Projects

### Production Environment
- **Lovable Project**: `payrun-pro`
- **GitHub Branch**: `main`
- **Supabase Database**: `kctwfgbjmhnfqtxhagib` (Nalungu's Payroll)
- **Environment**: Production

### Staging Environment  
- **Lovable Project**: `payrun-pro-staging`
- **GitHub Branch**: `staging`
- **Supabase Database**: `sbphmrjoappwlervnbtm` (Payroll-Staging)
- **Environment**: Staging

## ðŸ” Verification Steps

### Step 1: Check Lovable Dashboard
1. Go to [https://lovable.dev/dashboard](https://lovable.dev/dashboard)
2. Sign in with your account
3. Verify you have two projects:
   - **payrun-pro** (Production)
   - **payrun-pro-staging** (Staging)

### Step 2: Verify GitHub Integration
For each project:
1. Click on the project
2. Go to **Settings** â†’ **GitHub Integration**
3. Verify the repository is connected: `Q-Sourcing/payrun-pro`
4. Check the branch mapping:
   - **payrun-pro** â†’ `main` branch
   - **payrun-pro-staging** â†’ `staging` branch

### Step 3: Verify Supabase Integration
For each project:
1. Go to **Settings** â†’ **Integrations** â†’ **Supabase**
2. Check the database connections:
   - **payrun-pro** â†’ `kctwfgbjmhnfqtxhagib` (Production DB)
   - **payrun-pro-staging** â†’ `sbphmrjoappwlervnbtm` (Staging DB)

### Step 4: Test Auto-Deployment
1. Make a small change to your code
2. Commit and push to `staging` branch
3. Check if `payrun-pro-staging` auto-deploys
4. Commit and push to `main` branch  
5. Check if `payrun-pro` auto-deploys

## ðŸš¨ Troubleshooting

### Common Issues

#### 1. No Auto-Deployment
**Symptoms**: Changes pushed but no deployment triggered
**Solutions**:
- Check GitHub integration is connected
- Verify branch mapping is correct
- Check Lovable project is active
- Ensure repository has proper permissions

#### 2. Wrong Environment
**Symptoms**: Staging changes deploy to production
**Solutions**:
- Verify branch mapping in Lovable settings
- Check GitHub branch protection rules
- Ensure environment variables are correct

#### 3. Supabase Connection Issues
**Symptoms**: App deploys but can't connect to database
**Solutions**:
- Check Supabase integration settings
- Verify API keys are correct
- Check RLS policies allow access
- Test database connection manually

### Verification Commands

#### Test GitHub Integration
```bash
# Check current branch
git branch

# Check remote repository
git remote -v

# Test push to staging
git checkout staging
echo "Test deployment $(date)" >> DEPLOYMENT_TEST.md
git add DEPLOYMENT_TEST.md
git commit -m "test: verify staging auto-deployment"
git push origin staging

# Test push to main
git checkout main
echo "Test deployment $(date)" >> DEPLOYMENT_TEST.md
git add DEPLOYMENT_TEST.md
git commit -m "test: verify production auto-deployment"
git push origin main
```

#### Test Environment Variables
```bash
# Check environment detection
node scripts/testCredentials.cjs

# Verify environment badges
npm run dev
# Open browser and check login screen for environment badge
```

## ðŸ“Š Deployment Status

### Expected Workflow
1. **Code Change** â†’ Commit to GitHub
2. **GitHub Push** â†’ Triggers Lovable webhook
3. **Lovable Build** â†’ Compiles and builds app
4. **Lovable Deploy** â†’ Deploys to Lovable hosting
5. **Environment Badge** â†’ Shows correct environment
6. **Database Connection** â†’ Connects to correct Supabase

### Monitoring
- **Lovable Dashboard**: Check deployment status
- **GitHub Actions**: Monitor build workflows
- **Supabase Dashboard**: Check database activity
- **Health Reports**: Weekly automated reports

## ðŸ”§ Configuration Files

### GitHub Actions
- `.github/workflows/deploy-staging.yml` - Staging deployment
- `.github/workflows/deploy-production.yml` - Production deployment
- `.github/workflows/environment-health.yml` - Health monitoring

### Environment Files
- `.env` - Production configuration
- `.env.staging` - Staging configuration
- `.env.production` - Production template

### Scripts
- `scripts/verifyEnv.cjs` - Environment validation
- `scripts/testCredentials.cjs` - Credential testing
- `scripts/sendHealthReport.cjs` - Health reporting

## ðŸ“ž Support

### Lovable Support
- Check Lovable documentation
- Contact Lovable support for integration issues
- Verify project settings and permissions

### GitHub Support
- Check repository settings
- Verify webhook configurations
- Review branch protection rules

### Supabase Support
- Check database connectivity
- Verify API key permissions
- Review RLS policies

---
*Generated by Q-Payroll integration setup system*
